# KTC API (Kona Traffic Controller API) ğŸ˜

## Requirement

- **`KTC`** ëª¨ë“ˆì—ì„œ í™œìš©ë˜ëŠ” íŠ¸ë˜í”½ ì œì–´ ì •ë³´ ê´€ë¦¬ ë‹´ë‹¹
    - **`Zone`** ì •ë³´ ì„¤ì •ì„ ìœ„í•œ API ì„œë¹„ìŠ¤ ì œê³µ
    - íŠ¸ë˜í”½ ëŒ€ê¸° ë§Œë£Œ Token ì‚­ì œ ìŠ¤ì¼€ì¥´ë§ ì²˜ë¦¬
- ì‹¤ì‹œê°„ íŠ¸ë˜í”½ ëŒ€ê¸° í˜„í™© ì¡°íšŒ ì„œë¹„ìŠ¤ ì œê³µ
- ì‹¤ì‹œê°„ íŠ¸ë˜í”½ ëŒ€ê¸°/ì§‘ì… ìš”ì²­ row ë°ì´í„° ì €ì¥
- íŠ¸ë˜í”½ ëŒ€ê¸° í†µê³„/ì§‘ê³„ ë°ì´í„° ì €ì¥ ë° ì¡°íšŒ ì„œë¹„ìŠ¤ ì œê³µ

---

## Architecture

### Zone ì„¤ì • ê´€ë¦¬

> `Zone` : íŠ¸ë˜í”½ ì œì–´ ëŒ€ìƒ or ì˜ì—­ (e.g. ë©”ì¸í™”ë©´ ì§„ì…, ì¶©ì „ ìš”ì²­, ë“±ë“±..)

- íŠ¸ë˜í”½ ì œì–´ë¥¼ ìœ„í•œ `Zone` ì„¤ì • ì •ë³´
- `Zone` ì„¤ì • ì •ë³´ëŠ” RDBMS ì €ì¥ í›„ íŠ¸ë˜í”½ ì œì–´ í•„ìˆ˜ ì •ë³´ëŠ” Redis ë³„ë„ ì €ì¥ ì²˜ë¦¬ 

|      Field       |   Type   | ì„¤ëª…                |
|:----------------:|:--------:|-------------------|
|       `id`       | `String` | `Zone` ê³ ìœ  ì‹ë³„ ID   | 
|      `name`      | `String` | `Zone` ëª…ì¹­         |
|   `threshold`    | `Number` | `Zone` íŠ¸ë˜í”½ ì œì–´ ì„ê³„ì¹˜ |
| `activationTime` | `String` | `Zone` í™œì„±í™” ì‹œê°„     |
|     `status`     | `String` | `Zone` ìƒíƒœ         |

> #### Zone ìƒíƒœ ê´€ë¦¬
> 
> |  `status`   | ì„¤ëª…                     |
> |:-----------:|------------------------|
> |  `ACTIVE`   | `Zone` íŠ¸ë˜í”½ ì œì–´ í™œì„±í™” ìƒíƒœ   |
> | `SUSPENDED` | `Zone` íŠ¸ë˜í”½ ì§„ì… ì „ì²´ ì°¨ë‹¨ ìƒíƒœ | 
> |  `DELETED`  | `Zone` ì‚­ì œ ìƒíƒœ           | 

### Zone íŠ¸ë˜í”½ í˜„í™© ê´€ë¦¬

- `Zone` ë³„ ì‹¤ì‹œê°„ íŠ¸ë˜í”½ í˜„í™© ì •ë³´
- Redis ì €ì¥ íŠ¸ë˜í”½ ëŒ€ê¸° ì •ë³´ ì¡°íšŒí•˜ì—¬ ì •ë³´ ì œê³µ ì²˜ë¦¬

|       Field        |   Type   | ì„¤ëª…                        |
|:------------------:|:--------:|---------------------------|
|   `waitingCount`   | `Number` | í˜„ì¬ `Zone` íŠ¸ë˜í”½ ëŒ€ê¸°ì ìˆ˜       | 
|    `entryCount`    | `Number` | í˜„ì¬ `Zone` íŠ¸ë˜í”½ ì§„ì…ì ìˆ˜       | 
| `maxEstimatedTime` | `Number` | í˜„ì¬ `Zone` íŠ¸ë˜í”½ ìµœëŒ€ ëŒ€ê¸° ì˜ˆìƒ ì‹œê°„ |

#### íŠ¸ë˜í”½ í˜„í™© ì •ë³´ ì¡°íšŒ

- `waitingCount` : `ktc:{<zoneId>}:zqueue` ìºì‹œ ì •ë³´ì˜ ì „ì²´ í¬ê¸° ì¡°íšŒ
- `entryCount` : `ktc:{<zoneId>}:entry_counter` ìºì‹œ ì •ë³´ ì¡°íšŒ
- `maxEstimatedTime` : `waitingCount / threshold` ê³„ì‚° ê²°ê³¼ê°’
  - `threshold`: `ktc:{<zoneId>}:threshold` ìºì‹œ ì •ë³´ ì¡°íšŒ or DB ì¡°íšŒ

---
